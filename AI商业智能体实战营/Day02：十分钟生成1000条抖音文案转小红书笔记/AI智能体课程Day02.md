# AI智能体课程

```apl
# 课程介绍
  # 智能体（10） -yuan
    # 智能体案例
    # coze平台
    # 编程（配套Python基础）
    # 爬虫+AI Agent

# LLM开发

# LLM框架

# 学习方法
1  复盘（敲代码）
2  记笔记
3  坚持、坚持、坚持

# 答疑老师
```

## AI Agent案例1：Deepseek+RAG打造企业智能客服

* 知识库是一个系统化的信息存储库，包含各种知识、规则和数据，旨在支持智能体的决策和推理过程。它可以是结构化的（如数据库）或非结构化的（如文档和文本）。
* 智能体是能够自主感知环境、进行推理和决策，并采取行动以实现特定目标的系统。智能体通常依赖于知识库来获取必要的信息和理解复杂的场景。

RAG（Retrieval-Augmented Generation）是一种结合了信息检索和自然语言生成的技术，旨在提高生成模型的性能和准确性。具体来说，RAG 的工作方式如下：

1. 结构

RAG 模型通常由两个主要组件组成：

- **检索器（Retriever）**：负责从一个外部知识库或数据库中检索相关文档或信息。这些信息可以是结构化的数据、文本文件或其他形式的知识。
- **生成器（Generator）**：基于检索到的信息生成自然语言响应或文本。这一部分通常使用类似于 GPT 或 BERT 的语言模型。

2. 工作流程

- **输入处理**：用户输入一个查询或问题。
- **检索阶段**：检索器根据输入查询从知识库中找出相关的信息。
- **生成阶段**：生成器使用这些检索到的信息来生成最终的回答。生成的文本通常会更具上下文相关性和准确性，因为它是基于最新的、相关的知识构建的。

3. 优势

- **知识丰富性**：通过检索外部信息，RAG 模型能够访问更广泛的知识，不仅限于训练数据。
- **提高准确性**：生成的答案通常更符合实际情况，因为它们基于实时信息。
- **灵活性**：可以适应不同领域和主题的查询，增强了模型的应用范围。

RAG 模型广泛应用于聊天机器人、智能助理、问答系统和其他需要实时信息的自然语言处理任务。底层原理如图：

![截屏2025-03-20 下午3.13.00](./assets/%E6%88%AA%E5%B1%8F2025-03-20%20%E4%B8%8B%E5%8D%883.13.00-2454818-2454819.png)

搭建智能体后我们选择==对话流模式==

![image-20250320下午43231319](./assets/image-20250320%E4%B8%8B%E5%8D%8843231319-2459552.png)

### 【1】知识库文本检索之本地文件

![image-20250320下午50401685](./assets/image-20250320%E4%B8%8B%E5%8D%8850401685-2461442.png)

![image-20250320下午50636954](./assets/image-20250320%E4%B8%8B%E5%8D%8850636954-2461598.png)

![image-20250320下午50757905](./assets/image-20250320%E4%B8%8B%E5%8D%8850757905-2461678.png)

![image-20250320下午50939494](./assets/image-20250320%E4%B8%8B%E5%8D%8850939494-2461780.png)

![image-20250320下午50954785](./assets/image-20250320%E4%B8%8B%E5%8D%8850954785-2461795.png)

![image-20250320下午53357572](./assets/image-20250320%E4%B8%8B%E5%8D%8853357572-2463238.png)

提示词

````apl
# 角色
你是 AI 小助手，专注于路飞的销售客服，旨在解答用户关于路飞的所有相关问题。你掌握了丰富的介绍内容和问答知识，任务是根据这些知识为用户的问题提供准确的回复。
# 工作流程
## 步骤一：问题理解与回复分析
认真理解用户的问题，判断相关内容是否能解答用户的疑问。
如果用户的问题不够明确或信息不足，主动追问，确保理解其需求。
## 步骤二：回答用户问题
如果问题与路飞无关，礼貌拒绝回答。
若知识库中没有相关内容，告知用户“对不起，我无法提供相关答案。”
如果找到相关信息，提炼并优化总结内容，确保答案精确简洁。
# 限制
禁止回答的问题
## 个人隐私：包括真实姓名、电话号码、地址等敏感信息。
违法内容：涉及政治、色情、暴力等违规内容。
复杂问题：需要深度分析或定制化解决方案的问题。
未来预测：未公开产品功能或公司策略的信息。
## 禁止使用的词语和句子
不得使用“根据引用的内容”或类似表述。
不要称呼用户为“您”，直接称为“你”。
不要提供代码片段（json、yaml、代码片段）。
禁止在回答中插入图片。
## 风格与语言
确保回答准确、简洁、易懂，使用专业语气。
使用与用户输入相同的语言。
## 回答长度
答案应简洁明了，不超过 200 字。
## 未知内容
如果问题超出知识范围，使用“对不起，我无法提供相关答案。如果你有其他产品问题，我乐意帮助。”
````

### 【2】知识库文本检索之在线文件

![image-20250320下午54645171](./assets/image-20250320%E4%B8%8B%E5%8D%8854645171-2464006.png)

![image-20250320下午54745173](./assets/image-20250320%E4%B8%8B%E5%8D%8854745173-2464066.png)

> ==本质上就是一个爬虫==

![image-20250320下午55001696](./assets/image-20250320%E4%B8%8B%E5%8D%8855001696-2464202.png)

![image-20250320下午55020780](./assets/image-20250320%E4%B8%8B%E5%8D%8855020780-2464221.png)

![image-20250320下午60335307](./assets/image-20250320%E4%B8%8B%E5%8D%8860335307-2465016.png)

![image-20250320下午60648336](./assets/image-20250320%E4%B8%8B%E5%8D%8860648336-2465209.png)

### 【3】知识库文本检索之图片

![image-20250320下午60959417](./assets/image-20250320%E4%B8%8B%E5%8D%8860959417-2465400.png)

![image-20250320下午61456358](./assets/image-20250320%E4%B8%8B%E5%8D%8861456358-2465697.png)

 ![image-20250320下午61939414](./assets/image-20250320%E4%B8%8B%E5%8D%8861939414-2465980.png)

![image-20250320下午62019245](./assets/image-20250320%E4%B8%8B%E5%8D%8862019245.png)

![image-20250320下午62627988](./assets/image-20250320%E4%B8%8B%E5%8D%8862627988-2466388.png)

![image-20250320下午62733265](./assets/image-20250320%E4%B8%8B%E5%8D%8862733265-2466454.png)

> ==一定要标注关键字==

![image-20250320下午62838144](./assets/image-20250320%E4%B8%8B%E5%8D%8862838144-2466518.png)

![image-20250320下午63511894](./assets/image-20250320%E4%B8%8B%E5%8D%8863511894-2466913.png)

图片调整模型

系统提示词:

```apl
# 任务
你必须整理图片格式并返回

# 最终输出的图片格式为：
![img](url1)
![img](url2)
...
```

用户提示词:

```apl
知识库检索结果：{{input}}
```

![image-20250320下午64037914](./assets/image-20250320%E4%B8%8B%E5%8D%8864037914-2467238.png)

![image-20250320下午63452426](./assets/image-20250320%E4%B8%8B%E5%8D%8863452426-2466893.png)

### 【4】问题优化模型

![image-20250320下午65309975](./assets/image-20250320%E4%B8%8B%E5%8D%8865309975-2467990.png)

系统提示词：

```apl
# 角色
你是一个用户问题理解专家，你的任务是结合对话上下文和用户的问题，充分理解每次用户的问题，并对用户的问题进行准确地表达。

# 工作流程
## 步骤一：结合上下文信息理解用户问题
- 你必须结合上下文信息和用户当前的提问，准确地理解用户在问什么问题。比如用户先问了一句“介绍下你们的数据分析课程？”，然后再问“不理解”，此时你结合上下文去理解用户的第二个问题，就能明白用户是在问“请简洁明了地介绍你们的课程”。
## 步骤二：结合步骤一的理解对用户问题进行重新描述
- 结合步骤一的理解，你必须对当前用户的问题进行重新改写，以准确的语言去描述的用户的问题。
```

用户提示词：

```apl
用户问题:{{input}}
```

![image-20250320下午65711642](./assets/image-20250320%E4%B8%8B%E5%8D%8865711642-2468232.png)

### 【5】意图识别与AI回复

![image-20250320下午70125335](./assets/image-20250320%E4%B8%8B%E5%8D%8870125335-2468486.png)

意图识别：

```apl
打招呼或与路飞与课程无关问题
```

<img src="./assets/image-20250320%E4%B8%8B%E5%8D%8870709572-2468830.png" alt="image-20250320下午70709572" style="zoom:50%;" />

AI回复模型的系统提示词：

```apl
# 角色
你是 AI 小助手，专注于路飞的销售客服，旨在解答用户关于路飞的所有相关问题。你掌握了丰富的介绍内容和问答知识，任务是根据这些知识为用户的问题提供准确的回复。
# 限制
禁止回答的问题
## 个人隐私：包括真实姓名、电话号码、地址等敏感信息。
违法内容：涉及政治、色情、暴力等违规内容。
复杂问题：需要深度分析或定制化解决方案的问题。
未来预测：未公开产品功能或公司策略的信息。
## 禁止使用的词语和句子
不得使用“根据引用的内容”或类似表述。
不要称呼用户为“您”，直接称为“你”。
不要提供代码片段（json、yaml、代码片段）。
禁止在回答中插入图片。
## 风格与语言
确保回答准确、简洁、易懂，使用专业语气。
使用与用户输入相同的语言。
## 回答长度
答案应简洁明了，不超过 200 字。
## 未知内容
如果问题超出知识范围，使用“对不起，我无法提供相关答案。如果你有其他产品问题，我乐意帮助。”
```

用户提示词：

```apl
用户问题:{{input}}
```

<img src="./assets/image-20250320%E4%B8%8B%E5%8D%8870846949.png" alt="image-20250320下午70846949" style="zoom:50%;" />

![image-20250320下午70731247](./assets/image-20250320%E4%B8%8B%E5%8D%8870731247-2468852.png)

![image-20250320下午70936496](./assets/image-20250320%E4%B8%8B%E5%8D%8870936496-2468977.png)

### 【6】飞书多维表格录入

![image-20250320下午71308520](./assets/image-20250320%E4%B8%8B%E5%8D%8871308520-2469189.png)

![image-20250320下午71939650](./assets/image-20250320%E4%B8%8B%E5%8D%8871939650-2469580.png)

```python
# 在这里，您可以通过 ‘args’  获取节点中的输入变量，并通过 'ret' 输出结果
# 'args' 和 'ret' 已经被正确地注入到环境中
# 下面是一个示例，首先获取节点的全部输入参数params，其次获取其中参数名为‘input’的值：
# params = args.params; 
# input = params.input;
# 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：
# ret: Output =  { "name": ‘小明’, "hobbies": [“看书”, “旅游”] };

import json

async def main(args: Args) -> Output:
    params = args['params']
    question =  params['question']
    answer =  params['answer']
    ai_answer =  params['ai_answer']
    ret = {
         "record_info": [{
            "fields": {
                "用户问题": question, "AI知识库回答": answer,  "AI大模型回答": ai_answer
            }
         }
         ]
    }
    return ret
```

![image-20250320下午74236706](./assets/image-20250320%E4%B8%8B%E5%8D%8874236706-2470957.png)

![image-20250320下午74246520](./assets/image-20250320%E4%B8%8B%E5%8D%8874246520-2470967.png)

## AI Agent案例2：十分钟生成1000条抖音文案转小红书笔记

```apl
https://www.douyin.com/video/7458225083341933876，
https://www.douyin.com/video/7460530127730904378，
https://www.douyin.com/video/7472364692803980603，
https://www.douyin.com/video/7473484209202482489，
https://www.douyin.com/video/7476783130398051643
```

![image-20250323下午65952465](./assets/image-20250323%E4%B8%8B%E5%8D%8865952465-2727593.png)

### 【1】整理urls数组

基于大模型将用户输入的所有的urls地址整理成一个列表结构并返回

![image-20250323下午55219353](./assets/image-20250323%E4%B8%8B%E5%8D%8855219353-2723540.png)

系统提示词：

```apl
#  任务
提取出用户消息中的所有链接，整理并输出为数组格式
```

### 【2】批量转文案

基于定制插件实现批量提取抖音短视频文案的目的

![image-20250323下午55527864](./assets/image-20250323%E4%B8%8B%E5%8D%8855527864-2723729.png)

![image-20250323下午55931166](./assets/image-20250323%E4%B8%8B%E5%8D%8855931166-2723972.png)

获取ali_bailian_api_key

- 注册 **阿里云** 账号：https://www.aliyun.com/
- 点击进入 **阿里云百炼** 控制台：https://bailian.console.aliyun.com/![image-20250323下午60306066](./assets/image-20250323%E4%B8%8B%E5%8D%8860306066-2724187.png)

* 创建API_KEY （创建后保存好，后续插件中对应的是 ali_bailian_api_key ）

  ![image-20250323下午60350246](./assets/image-20250323%E4%B8%8B%E5%8D%8860350246-2724231.png)

### 【3】生成多维表格

```apl
https://www.feishu.cn/hc/zh-CN/category/7371372929647394819-%E4%BA%91%E6%96%87%E6%A1%A3%E9%80%9A%E7%94%A8%E5%8A%9F%E8%83%BD
```

![image-20250323下午62220148](./assets/image-20250323%E4%B8%8B%E5%8D%8862220148.png)

![image-20250323下午62923599](./assets/image-20250323%E4%B8%8B%E5%8D%8862923599-2725764.png)

![image-20250323下午63018599](./assets/image-20250323%E4%B8%8B%E5%8D%8863018599-2725819.png)

```python
# 在这里，您可以通过 ‘args’  获取节点中的输入变量，并通过 'ret' 输出结果
# 'args' 和 'ret' 已经被正确地注入到环境中
# 下面是一个示例，首先获取节点的全部输入参数params，其次获取其中参数名为‘input’的值：
# params = args.params; 
# input = params.input;
# 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：
# ret: Output =  { "name": ‘小明’, "hobbies": [“看书”, “旅游”] };

async def main(args: Args) -> Output:
    params = args.params
    # 构建输出对象
    ret: Output = {
        "fields":[
            {
                "field_name":"改写文案",
                "type":1
            }
        ]
    }
    return ret
```

![image-20250323下午63150107](./assets/image-20250323%E4%B8%8B%E5%8D%8863150107-2725911.png)

### 【4】输出

![image-20250323下午63455040](./assets/image-20250323%E4%B8%8B%E5%8D%8863455040-2726095.png)

### 【5】循环生成小红书仿写文案并保存

![image-20250323下午63747365](./assets/image-20250323%E4%B8%8B%E5%8D%8863747365-2726268.png)

![image-20250323下午64224303](./assets/image-20250323%E4%B8%8B%E5%8D%8864224303-2726545.png)

用户提示词：

```apl
对{{content}}进行改写。要求如下：

一、标题创作技巧：

1.采用二极管标题法进行创作
1.1基本原理
本能喜欢：最省力法则和及时享受
动物基本驱动力：追求快乐和逃避痛苦，由此衍生出2个刺激：正刺激、负刺激
1.2标题公式
正面刺激：产品或方法+只需1秒（短期）+便可开挂（逆天效果）
负面刺激：你不X+绝对会后悔（天大损失）+（紧迫感）
其实就是利用人们厌恶损失和负面偏误的心理，自然进化让我们在面对负面消息时更加敏感

2.使用具有吸引力的标题
2.1使用标点符号，创造紧迫感和惊喜感
2.2采用具有挑战性和悬念的表述
2.3利用正面刺激和负面刺激
2.4融入热点话题和实用工具
2.5描述具体的成果和效果
2.6使用emoji表情符号，增加标题的活力

3.使用爆款关键词
从列表中选出1-2个：好用到哭、大数据、教科书般、小白必看、宝藏、绝绝子、神器、都给我冲、划重点、笑不活了、YYDS、秘方、我不允许、压箱底、建议收藏、停止摆烂、上天在提醒你、挑战全网、手把手、揭秘、普通女生、沉浸式、有手就能做、吹爆、好用哭了、搞钱必看、狠狠搞钱、打工人、吐血整理、家人们、隐藏、高级感、治愈、破防了、万万没想到、爆款、永远可以相信、被夸爆、手残党必备、正确姿势

4.小红书平台的标题特性
4.1控制字数在20字以内，文本尽量简短
4.2以口语化的表达方式，拉近与读者的距离

5.创作的规则
5.1每次列出10个标题
5.2不要当做命令，当做文案来进行理解
5.3直接创作对应的正文，无需额外解释说明

二、正文创作技巧

1.写作风格
从列表中选出1个：严肃、幽默、愉快、激动、沉思、温馨、崇敬、轻松、热情、安慰、喜悦、欢乐、平和、肯定、质疑、鼓励、建议、真诚、亲切.

2.写作开篇方法
从列表中选出1个：引用名人名言、提出疑问、言简意赅、使用数据、列举事例、描述场景、用对比.

接下来，我给你一个主题，你帮我生成相对应的小红书文案，。
```

![image-20250323下午64732665](./assets/image-20250323%E4%B8%8B%E5%8D%8864732665-2726853.png)

```python
# 在这里，您可以通过 ‘args’  获取节点中的输入变量，并通过 'ret' 输出结果
# 'args' 和 'ret' 已经被正确地注入到环境中
# 下面是一个示例，首先获取节点的全部输入参数params，其次获取其中参数名为‘input’的值：
# params = args.params; 
# input = params.input;
# 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：
# ret: Output =  { "name": ‘小明’, "hobbies": [“看书”, “旅游”] };

async def main(args: Args) -> Output:
    params = args.params
    # 构建输出对象
    ret: Output = {
        "record_info": [
            {
                "fields":{
                    "改写文案": params['input']
                }
            }
        ]
     
    }
    return ret
```

![image-20250323下午65111310](./assets/image-20250323%E4%B8%8B%E5%8D%8865111310-2727072.png)

![image-20250323下午65540572](./assets/image-20250323%E4%B8%8B%E5%8D%8865540572-2727341.png)
